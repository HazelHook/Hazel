NODE aggregate
SQL >

    SELECT
        toStartOfHour(timestamp) AS bucket,
        customer_id,
        source_id,
        version
    FROM request_events
    GROUP BY
        bucket,
        source_id,
        customer_id,
        version

TYPE materialized
DATASOURCE hourly_req_mv
ENGINE "AggregatingMergeTree"
ENGINE_PARTITION_KEY "toYYYYMM(bucket)"
ENGINE_SORTING_KEY "bucket, source_id, customer_id, version"
ENGINE_TTL "bucket + toIntervalDay(120)"

